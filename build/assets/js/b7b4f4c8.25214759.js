"use strict";(self.webpackChunkWhaTap_Docs=self.webpackChunkWhaTap_Docs||[]).push([[8219],{42504:(e,t,n)=>{n.d(t,{Ay:()=>c,RM:()=>s});var a=n(74848),i=n(28453);const s=[{value:"Active Stack for Background Threads",id:"active-stack-for-background-threads",level:2}];function r(e){const t={code:"code",h2:"h2",li:"li",p:"p",pre:"pre",section:"section",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(t.section,{className:"remark-sectionize-h2",children:[(0,a.jsx)(t.h2,{id:"active-stack-for-background-threads",children:"Active Stack for Background Threads"}),(0,a.jsxs)(t.p,{children:["Basically, the ",(0,a.jsx)(t.strong,{children:"active stack"})," means the stack of the thread in which transactions are being processed. You may need to analyze the stack for some background threads as well. At this time, the ** for the background thread can be obtained using the option. It is available in the Java agent 1.6.2 or later."]}),(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsxs)(t.p,{children:["If the value of ",(0,a.jsx)(t.code,{children:"async_stack_enabled"})," is set to ",(0,a.jsx)(t.code,{children:"true"}),", the function is enabled."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-ini",metastring:'title="whatap.conf"',children:"async_stack_enabled=false\n"})}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"The stack dump interval depends on the foreground active stack setting."}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-ini",metastring:'title="whatap.conf"',children:"active_stack_second=10\n"})}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsxs)(t.p,{children:["When setting the target thread name, use ",(0,a.jsx)(t.code,{children:"*"})," to specify the string pattern."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-ini",metastring:'title="whatap.conf"',children:"async_thread_match=http*,abc*\n"})}),"\n",(0,a.jsx)(t.p,{children:"It identifies the stack dump target with the thread name. You can specify multiple matches using comma (,) as the delimiter."}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsxs)(t.p,{children:["When the Top method of the stack is a class or method registered in ",(0,a.jsx)(t.code,{children:"async_thread_parking"}),", it determines that the thread has been parked and does not generate a dump."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-ini",metastring:'title="whatap.conf"',children:"async_thread_parking_class=sun.misc.Unsafe\nasync_thread_parking_method=park\n"})}),"\n"]}),"\n"]})]})}function c(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(r,{...e})}):r(e)}},16181:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>g,contentTitle:()=>u,default:()=>x,frontMatter:()=>p,metadata:()=>m,toc:()=>v});var a=n(74848),i=n(28453);function s(e){const t={admonition:"admonition",code:"code",em:"em",h2:"h2",li:"li",p:"p",pre:"pre",section:"section",strong:"strong",ul:"ul",...(0,i.R)(),...e.components},{Cmdname:n,InDoc:s}=t;return n||c("Cmdname",!0),s||c("InDoc",!0),(0,a.jsxs)(t.section,{className:"remark-sectionize-h2",children:[(0,a.jsx)(t.h2,{id:"collecting-the-compact-active-stacks",children:"Collecting the compact active stacks"}),(0,a.jsx)(t.p,{children:"Because the active stack regularly performs thread dumps, it can add lots of overheads to the agent if implemented incorrectly. WhaTap has various options to collect active stacks while minimizing the agent load."}),(0,a.jsx)(t.admonition,{type:"tip",children:(0,a.jsxs)(t.p,{children:["In ",(0,a.jsx)(n,{sid:"side_agentsConfiguration",className:"uitext"})," > ",(0,a.jsx)(n,{sid:"side_threadList",className:"uitext"}),", from the thread list, the overhead can be determined by checking the ",(0,a.jsx)(n,{sid:"cpu_time",className:"uitext"})," of the ",(0,a.jsx)(t.em,{children:(0,a.jsx)(t.strong,{children:"WhaTap-ActiveStackDump"})})," thread."]})}),(0,a.jsx)(t.p,{children:(0,a.jsx)(t.strong,{children:"Active Stack Example"})}),(0,a.jsx)(s,{product:"java,python",children:(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-java",metastring:"title='JAVA'",children:"java.lang.StringBuffer.append(StringBuffer.java:309)\njava.util.regex.Matcher.appendReplacement(Matcher.java:839)\njava.util.regex.Matcher.replaceAll(Matcher.java:906)\njava.lang.String.replaceAll(String.java:2162)\ncore.log.triggers.TriggerRegister.changeNotify(TriggerRegister.java:114)\ncore.log.aop.handler.DaoInfo.log(DaoInfo.java:141)\ncore.log.aop.handler.DaoInfo.doAround(DaoInfo.java:102)\ncore.log.aop.reflection.profiler.AroundProfiler.invoke(AroundProfiler.java:19)\ncom.sun.proxy.$Proxy39.getUpdateCount(Unknown Source)\norg.apache.ibatis.executor.resultset.DefaultResultSetHandler.getNextResultSet(DefaultResultSetHandler.java:256)\norg.apache.ibatis.executor.resultset.DefaultResultSetHandler.handleResultSets(DefaultResultSetHandler.java:193)\norg.apache.ibatis.executor.statement.PreparedStatementHandler.query(PreparedStatementHandler.java:64)\n\n* * *\n\nsun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:606)\norg.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:221)\norg.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:136)\norg.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:114)\norg.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:827)\n"})})}),(0,a.jsx)(s,{product:"dotnet",children:(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-csharp",metastring:"title='.NET'",children:"DomainNeutralILStubClass.IL_STUB_ReversePInvoke(Int64,Int64,Int64,Int32)\nSystem.Web.Hosting.PipelineRuntime.ProcessRequestNotification(IntPtr,IntPtr,IntPtr,Int32)\nSystem.Web.Hosting.PipelineRuntime.ProcessRequestNotificationHelper(IntPtr,IntPtr,IntPtr,Int32)\nDomainNeutralILStubClass.IL_STUB_PInvoke(IntPtr,System.Web.RequestNotificationStatus ByRef)\nSystem.Threading.ThreadHelper.ThreadStart()\nSystem.Threading.ExecutionContext.Run(System.Threading.ExecutionContext,System.Threading.ContextCallback,System.Object)\nSystem.Threading.ExecutionContext.Run(System.Threading.ExecutionContext,System.Threading.ContextCallback,System.Object,Boolean)\nSystem.Threading.ExecutionContext.RunInternal(System.Threading.ExecutionContext,System.Threading.ContextCallback,System.Object,Boolean)\nSystem.Net.TimerThread.ThreadProc()\nSystem.Threading.WaitHandle.WaitAny(System.Threading.WaitHandle[],Int32,Boolean)\nSystem.Threading.Thread.Sleep(Int32)\n"})})}),(0,a.jsx)(t.p,{children:(0,a.jsx)(t.strong,{children:"Optimized data collection"})}),(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"Dump the stack only for the thread that is performing transactions."}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"You can adjust the active stack dump time interval."}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-ini",metastring:'title="whatap.conf"',children:"active_stack_second=10\n"})}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"It is limited to the maximum line of the active stack. It collects 50 lines from the top line by default."}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-ini",metastring:'title="whatap.conf"',children:"trace_active_callstack_depth=50\n"})}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"Each hashed line of the active stack is collected. Text is collected only once."}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"The maximum number of active stacks collected at a time is limited."}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-ini",metastring:'title="whatap.conf"',children:"active_stack_count=100\n"})}),"\n"]}),"\n"]})]})}function r(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(s,{...e})}):s(e)}function c(e,t){throw new Error("Expected "+(t?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}var o=n(42504);const l=[{value:"Collecting the compact active stacks",id:"collecting-the-compact-active-stacks",level:2},...o.RM,{value:"References",id:"references",level:2}];function d(e){const t={a:"a",admonition:"admonition",code:"code",h2:"h2",li:"li",p:"p",section:"section",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(t.p,{children:['A transaction in progress is called "active transaction." ',(0,a.jsx)(t.strong,{children:"A stack that has been regularly dumped by an active transaction is called active stack"}),"."]}),"\n",(0,a.jsx)(t.admonition,{type:"note",children:(0,a.jsxs)(t.p,{children:["The WhaTap agent dumps active stacks for active transactions every 10 seconds (optional) and sends them to the server. ",(0,a.jsx)(t.code,{children:"active_stack_second=10"})]})}),"\n","\n",(0,a.jsx)(r,{}),"\n","\n",(0,a.jsx)(o.Ay,{}),"\n",(0,a.jsxs)(t.section,{className:"remark-sectionize-h2",children:[(0,a.jsx)(t.h2,{id:"references",children:"References"}),(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:(0,a.jsx)(t.a,{href:"https://brunch.co.kr/@leedongins/152",children:"Active Transaction"})}),"\n",(0,a.jsx)(t.li,{children:(0,a.jsx)(t.a,{href:"https://brunch.co.kr/@leedongins/31",children:"Active transactions that can detect failures quickly"})}),"\n"]})]})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}const p={id:"active-transactions",title:"Active Transaction",description:"It guides you to active transactions.",tags:["Java","Transactions","Active Transaction","UI","Application","Application Monitoring"]},u=void 0,m={id:"java/active-transactions",title:"Active Transaction",description:"It guides you to active transactions.",source:"@site/i18n/en/docusaurus-plugin-content-docs/current/java/active-transactions.mdx",sourceDirName:"java",slug:"/java/active-transactions",permalink:"/java/active-transactions",draft:!1,unlisted:!1,editUrl:"undefined/docs/java/active-transactions.mdx",tags:[{inline:!0,label:"Java",permalink:"/tags/java"},{inline:!0,label:"Transactions",permalink:"/tags/transactions"},{inline:!0,label:"Active Transaction",permalink:"/tags/active-transaction"},{inline:!0,label:"UI",permalink:"/tags/ui"},{inline:!0,label:"Application",permalink:"/tags/application"},{inline:!0,label:"Application Monitoring",permalink:"/tags/application-monitoring"}],version:"current",frontMatter:{id:"active-transactions",title:"Active Transaction",description:"It guides you to active transactions.",tags:["Java","Transactions","Active Transaction","UI","Application","Application Monitoring"]},sidebar:"javaSidebar",previous:{title:"Transaction Tracing",permalink:"/java/trs-profile"},next:{title:"Multi-transaction",permalink:"/java/trs-multi-trace"}},g={},v=[...l];function j(e){return(0,a.jsx)(h,{})}function x(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(j,{...e})}):j()}},28453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>c});var a=n(96540);const i={},s=a.createContext(i);function r(e){const t=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),a.createElement(s.Provider,{value:t},e.children)}}}]);