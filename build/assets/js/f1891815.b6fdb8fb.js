"use strict";(self.webpackChunkWhaTap_Docs=self.webpackChunkWhaTap_Docs||[]).push([[65180],{58253:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>c,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>l});var i=t(74848),a=t(28453);t(67068),t(5379);const r={id:"golang-0_1_9",title:"Go Agent v0.1.9",toc_max_heading_level:2,displayed_sidebar:"releaseSidebar"},c=void 0,o={id:"release-notes/golang/golang-0_1_9",title:"Go Agent v0.1.9",description:"Release date: 2022-04-27",source:"@site/i18n/en/docusaurus-plugin-content-docs/current/release-notes/golang/golang-0.1.9.mdx",sourceDirName:"release-notes/golang",slug:"/release-notes/golang/golang-0_1_9",permalink:"/release-notes/golang/golang-0_1_9",draft:!1,unlisted:!1,editUrl:"undefined/docs/release-notes/golang/golang-0.1.9.mdx",tags:[],version:"current",frontMatter:{id:"golang-0_1_9",title:"Go Agent v0.1.9",toc_max_heading_level:2,displayed_sidebar:"releaseSidebar"},sidebar:"releaseSidebar"},s={},l=[{value:"Beta - bug fixing",id:"beta---bug-fixing",level:2},{value:"Fixed the bug where the web transaction data cannot be collected in a panic situation.",id:"fixed-the-bug-where-the-web-transaction-data-cannot-be-collected-in-a-panic-situation",level:3},{value:"Beta - update",id:"beta---update",level:2},{value:"Collecting the HTTP status code",id:"collecting-the-http-status-code",level:3},{value:"github.com/labstack/echo",id:"githubcomlabstackecho",level:3},{value:"Supporting the Echo/V4",id:"supporting-the-echov4",level:4},{value:"Adding the HTTPErrorHandler wrapper of the echo",id:"adding-the-httperrorhandler-wrapper-of-the-echo",level:4},{value:"Log output",id:"log-output",level:3},{value:"Adding the setting to exclude collection by specifying the HTTP method",id:"adding-the-setting-to-exclude-collection-by-specifying-the-http-method",level:3}];function d(e){const n={admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",section:"section",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"Release date: 2022-04-27"}),"\n",(0,i.jsx)(n.section,{className:"remark-sectionize-h2",children:(0,i.jsx)(n.h2,{id:"beta---bug-fixing",children:"Beta - bug fixing"})}),"\n",(0,i.jsxs)(n.section,{className:"remark-sectionize-h3",children:[(0,i.jsx)(n.h3,{id:"fixed-the-bug-where-the-web-transaction-data-cannot-be-collected-in-a-panic-situation",children:"Fixed the bug where the web transaction data cannot be collected in a panic situation."}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"net/http"}),"\n",(0,i.jsx)(n.li,{children:"github.com/labstack/echo"}),"\n",(0,i.jsx)(n.li,{children:"github.com/gorilla/mux"}),"\n",(0,i.jsx)(n.li,{children:"github.com/go-gonic/gin"}),"\n"]}),(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["Error data is collected through ",(0,i.jsx)(n.code,{children:"recover()"}),", but the same panic occurs again."]})}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",metastring:"title='Go'",children:'defer func() {\n  // panic \n  \n  x := recover()\n  var err error = nil\n  if x != nil {\n    err = fmt.Errorf("Panic: %v", x)\n    \n    // Collect the panic data.\n    trace.Error(ctx, err)\n    err = nil\n  }\n\n  ...\n\n  // Panic is generated again.\n\n  if x != nil {\n    panic(x)\n  }\n}()\n'})})]}),"\n",(0,i.jsx)(n.section,{className:"remark-sectionize-h2",children:(0,i.jsx)(n.h2,{id:"beta---update",children:"Beta - update"})}),"\n",(0,i.jsxs)(n.section,{className:"remark-sectionize-h3",children:[(0,i.jsx)(n.h3,{id:"collecting-the-http-status-code",children:"Collecting the HTTP status code"}),(0,i.jsx)(n.p,{children:"Status codes over 400 are collected as error messages."})]}),"\n",(0,i.jsx)(n.section,{className:"remark-sectionize-h3",children:(0,i.jsx)(n.h3,{id:"githubcomlabstackecho",children:"github.com/labstack/echo"})}),"\n",(0,i.jsxs)(n.section,{className:"remark-sectionize-h4",children:[(0,i.jsx)(n.h4,{id:"supporting-the-echov4",children:"Supporting the Echo/V4"}),(0,i.jsx)(n.p,{children:"Use echo/v4/whatapecho instead of the previous echo/whatapecho package."}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",metastring:"title='Go'",children:'import (\n  "github.com/labstack/echo"\n  \n  "github.com/whatap/go-api/trace"\n  "github.com/whatap/go-api/instrumentation/github.com/labstack/echo/v4/whatapecho"\n)\n'})})]}),"\n",(0,i.jsxs)(n.section,{className:"remark-sectionize-h4",children:[(0,i.jsx)(n.h4,{id:"adding-the-httperrorhandler-wrapper-of-the-echo",children:"Adding the HTTPErrorHandler wrapper of the echo"}),(0,i.jsx)(n.p,{children:"Additional error data is collected through HTTPErrorHandler."}),(0,i.jsxs)(n.p,{children:["The error data is collected when the ",(0,i.jsx)(n.code,{children:"echo.Context.Error()"})," function is called. The panic data processed by the recover middleware is collected."]}),(0,i.jsxs)(n.p,{children:["When the whatapecho middleware finally runs, it can collect as many data as possible from the HTTPErrorHandler. Set the middleware registration at the top, and the register it through the ",(0,i.jsx)(n.code,{children:"Pre()"})," function."]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",metastring:"title='Go'",children:"func main() {\n  ...\n\n  e := echo.New()\n  //echo DefaultHTTPErrorHandler wrapper\n  e.HTTPErrorHandler = whatapecho.WrapHTTPErrorHandler(e.DefaultHTTPErrorHandler)\n  e.Pre(whatapecho.Middleware())\n  e.Use(middleware.Recover())\n  ...\n}\n"})})]}),"\n",(0,i.jsxs)(n.section,{className:"remark-sectionize-h3",children:[(0,i.jsx)(n.h3,{id:"log-output",children:"Log output"}),(0,i.jsx)(n.p,{children:"If the debug option is set, the monitoring-related log is output."}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ini",children:"debug=true\n"})}),(0,i.jsx)(n.p,{children:"The logs for transactions, DB connections, SQL executions, and HTTP outbound calls have been added."})]}),"\n",(0,i.jsxs)(n.section,{className:"remark-sectionize-h3",children:[(0,i.jsx)(n.h3,{id:"adding-the-setting-to-exclude-collection-by-specifying-the-http-method",children:"Adding the setting to exclude collection by specifying the HTTP method"}),(0,i.jsx)(n.p,{children:"It excludes the collection of transactions requested by specific HTTP methods for the set URIs. Multiple URIs and methods can be registered using comma (,) as the delimiter. The values are case-insensitive."}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"ignore_http_method_urls"})}),"\n",(0,i.jsx)(n.p,{children:'#Default : ""#'}),"\n",(0,i.jsx)(n.p,{children:"#Type: string#"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"ignore_http_method"})}),"\n",(0,i.jsx)(n.p,{children:'#Default : ""#'}),"\n",(0,i.jsx)(n.p,{children:"#Type: string#"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ini",children:"ignore_http_method_urls=/index, /sql/select\nignore_http_method=options, connect\n"})}),"\n"]}),"\n"]})]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},67068:(e,n,t)=>{t.d(n,{A:()=>a});var i=t(74848);t(96540);function a({children:e,priority:n}){return n?(0,i.jsx)("code",{className:e,type:n,children:e}):(0,i.jsx)("code",{className:e,children:e})}},5379:(e,n,t)=>{t.d(n,{A:()=>a});var i=t(74848);t(96540);function a({children:e}){return(0,i.jsx)("span",{className:"uitext",children:e})}},28453:(e,n,t)=>{t.d(n,{R:()=>c,x:()=>o});var i=t(96540);const a={},r=i.createContext(a);function c(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:c(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);