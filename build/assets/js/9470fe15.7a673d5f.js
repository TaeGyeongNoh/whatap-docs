"use strict";(self.webpackChunkWhaTap_Docs=self.webpackChunkWhaTap_Docs||[]).push([[97204],{48797:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>s,default:()=>o,frontMatter:()=>r,metadata:()=>c,toc:()=>h});var a=n(74848),i=n(28453);n(67068),n(5379);const r={id:"php-2_4_0",title:"PHP Agent v2.4.0",toc_max_heading_level:2,displayed_sidebar:"releaseSidebar"},s=void 0,c={id:"release-notes/php/php-2_4_0",title:"PHP Agent v2.4.0",description:"Release date: 2021-12-16",source:"@site/i18n/en/docusaurus-plugin-content-docs/current/release-notes/php/php-2.4.0.mdx",sourceDirName:"release-notes/php",slug:"/release-notes/php/php-2_4_0",permalink:"/release-notes/php/php-2_4_0",draft:!1,unlisted:!1,editUrl:"undefined/docs/release-notes/php/php-2.4.0.mdx",tags:[],version:"current",frontMatter:{id:"php-2_4_0",title:"PHP Agent v2.4.0",toc_max_heading_level:2,displayed_sidebar:"releaseSidebar"},sidebar:"releaseSidebar"},d={},h=[{value:"Change (update)",id:"change-update",level:2},{value:"PHP 8.1",id:"php-81",level:3},{value:"Fixed (bug fixing)",id:"fixed-bug-fixing",level:2},{value:"cURL header setting data initialization error",id:"curl-header-setting-data-initialization-error",level:3}];function l(e){const t={code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",section:"section",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.p,{children:"Release date: 2021-12-16"}),"\n",(0,a.jsx)(t.section,{className:"remark-sectionize-h2",children:(0,a.jsx)(t.h2,{id:"change-update",children:"Change (update)"})}),"\n",(0,a.jsxs)(t.section,{className:"remark-sectionize-h3",children:[(0,a.jsx)(t.h3,{id:"php-81",children:"PHP 8.1"}),(0,a.jsx)(t.p,{children:"PHP 8.1 is supported."})]}),"\n",(0,a.jsx)(t.section,{className:"remark-sectionize-h2",children:(0,a.jsx)(t.h2,{id:"fixed-bug-fixing",children:"Fixed (bug fixing)"})}),"\n",(0,a.jsxs)(t.section,{className:"remark-sectionize-h3",children:[(0,a.jsx)(t.h3,{id:"curl-header-setting-data-initialization-error",children:"cURL header setting data initialization error"}),(0,a.jsxs)(t.p,{children:["When setting the HTTP header (CURLOPT_HTTPHEADER) through the ",(0,a.jsx)(t.code,{children:"curl_setopt"})," and ",(0,a.jsx)(t.code,{children:"curl_setopt_array"})," functions, if duplicate settings are made, the previous data is initialized and the new data is set."]}),(0,a.jsxs)(t.p,{children:["When the multi-transaction (",(0,a.jsx)(t.code,{children:"whatap.mtrace_enabled=true"}),") setting is enabled, there is an error in which the previous user header data is initialized by setting the Whatap Header data before the ",(0,a.jsx)(t.code,{children:"curl_exec()"})," function."]}),(0,a.jsxs)(t.p,{children:["The function to set the WhaTap Header has been removed before calling the ",(0,a.jsx)(t.code,{children:"curl_exec()"})," function and it has been modified to set it after calling the ",(0,a.jsx)(t.code,{children:"curl_init()"})," function."]}),(0,a.jsxs)(t.p,{children:["If the user header is set before the ",(0,a.jsx)(t.code,{children:"curl_exec()"})," function is called, the WhatTap header set in advance is deleted."]}),(0,a.jsx)(t.p,{children:"To do multi-transaction, add the WhatTap header directly in the PHP source code according to the following guide."}),(0,a.jsx)(t.p,{children:"Sample source code /usr/whatap/php/lib/Whatap/sample_mtrace.php"}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-php",metastring:"title='php'",children:'// Whatap installation directory (/usr/whatap/php/lib/Whatap/Whatap.php)  \n// Load Whatap.php. \ninclude_once \'./Whatap.php\';\n\n...\n\n// User header information\n$headers = array();\narray_push($headers, "aaaa:bbbb");\n\n// Add the Whatap header \n$whatap_mtrace = Whatap::whatap_get_mtrace();\nforeach ($whatap_mtrace as $key => $value){\n\t//echo $key."=".$value."<br/>";\n\tarray_push($headers, "$key:$value");\n}\nunset($value);\n\ncurl_setopt($ch, CURLOPT_HTTPHEADER, $headers);\n...\n'})}),(0,a.jsx)(t.p,{children:"You can adjust the automatic setup function with the following settings:"}),(0,a.jsx)(t.p,{children:(0,a.jsx)(t.code,{children:"whatap.mtrace_auto_inject_enabled=true"})}),(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:["After calling the ",(0,a.jsx)(t.code,{children:"curl_init()"})," function, the whatap header is set while internally calling ",(0,a.jsx)(t.code,{children:"curl_setopt()"}),"."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"false"}),": The automatic setting for the WhaTap header is stopped."]}),"\n"]})]})]})}function o(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},67068:(e,t,n)=>{n.d(t,{A:()=>i});var a=n(74848);n(96540);function i({children:e,priority:t}){return t?(0,a.jsx)("code",{className:e,type:t,children:e}):(0,a.jsx)("code",{className:e,children:e})}},5379:(e,t,n)=>{n.d(t,{A:()=>i});var a=n(74848);n(96540);function i({children:e}){return(0,a.jsx)("span",{className:"uitext",children:e})}},28453:(e,t,n)=>{n.d(t,{R:()=>s,x:()=>c});var a=n(96540);const i={},r=a.createContext(i);function s(e){const t=a.useContext(r);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),a.createElement(r.Provider,{value:t},e.children)}}}]);