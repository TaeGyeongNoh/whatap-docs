"use strict";(self.webpackChunkWhaTap_Docs=self.webpackChunkWhaTap_Docs||[]).push([["66193"],{11520:function(e,n,t){t.r(n),t.d(n,{metadata:()=>a,contentTitle:()=>d,default:()=>m,assets:()=>p,toc:()=>u,frontMatter:()=>h});var a=JSON.parse('{"id":"kubernetes/install-docker-java","title":"Installing Docker Java","description":"This step allows you to install the agent to monitor Java applications in the container.","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/kubernetes/install-docker-java.mdx","sourceDirName":"kubernetes","slug":"/kubernetes/install-docker-java","permalink":"/en/kubernetes/install-docker-java","draft":false,"unlisted":false,"editUrl":"undefined/docs/kubernetes/install-docker-java.mdx","tags":[],"version":"current","frontMatter":{"id":"install-docker-java","title":"Installing Docker Java","description":"This step allows you to install the agent to monitor Java applications in the container.","keywords":["Kubernetes","Kubernetes Monitoring","Application Installation","Java"],"toc_max_heading_level":2,"isTranslationMissing":false},"sidebar":"kubeSidebar","previous":{"title":"Application Agent Installation","permalink":"/en/kubernetes/install-application-agent"},"next":{"title":"Installing Docker Node.js","permalink":"/en/kubernetes/install-docker-nodejs"}}'),i=t("85893"),r=t("50065"),s=t("47902"),l=t("5525");function o(e){let n={code:"code",em:"em",h2:"h2",li:"li",p:"p",section:"section",strong:"strong",ul:"ul",...(0,r.a)(),...e.components};return(0,i.jsxs)(n.section,{className:"remark-sectionize-h2",children:[(0,i.jsx)(n.h2,{id:"checking-the-agent-installation",children:"Checking the agent installation"}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["To check whether the agent has been installed, go to ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Dashboard"})})," > ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Application Service Dashboard"})}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["If you have manually installed the downloaded file but cannot see the agent in ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Dashboard"})}),", check the following."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Execute the command, ",(0,i.jsx)(n.code,{children:"ps -ef | grep whatap"})," in the container, and then check whether the agent options have been applied properly."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Check the content of the container in the ",(0,i.jsx)(n.em,{children:"/whatap/logs"})," path. Agent logs are output in the format of ",(0,i.jsxs)(n.em,{children:["logs/",(0,i.jsx)(n.code,{children:"{whatap configuration file name}"}),"-yyyymmdd.log"]}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]})]})}function c(e={}){let{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}let h={id:"install-docker-java",title:"Installing Docker Java",description:"This step allows you to install the agent to monitor Java applications in the container.",keywords:["Kubernetes","Kubernetes Monitoring","Application Installation","Java"],toc_max_heading_level:2,isTranslationMissing:!1},d=void 0,p={},u=[{value:"Download agent",id:"download-agent",level:2},{value:"Setting the Kubernetes internal application agent options",id:"setting-the-kubernetes-internal-application-agent-options",level:4},{value:"Setting the security key",id:"security",level:3},{value:"Configuring the container environment variables",id:"configuring-the-container-environment-variables",level:2},{value:"Checking the agent installation",id:"checking-the-agent-installation",level:2}];function j(e){let n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",ol:"ol",p:"p",pre:"pre",section:"section",strong:"strong",ul:"ul",...(0,r.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["At the bottom of ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Management"})})," > ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Agent installation"})}),", click ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Install Application"})})," > Select the ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Docker Java"})})," tab in Install guide."]}),"\n",(0,i.jsx)(n.p,{children:"This process adds the settings for applying the agent to the JVM option of the Java application running on the Docker container and packages the container images as follows:"}),"\n",(0,i.jsxs)(n.admonition,{type:"note",children:[(0,i.jsx)(n.mdxAdmonitionTitle,{}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"EKS Fargate is to be supported later."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Git example code is provided to help you understand the Java application integration process. See ",(0,i.jsx)(n.a,{href:"https://github.com/whatap/kuber-apm-boilerplate/tree/main/java/springboot",children:"the following"}),"."]}),"\n"]}),"\n"]})]}),"\n",(0,i.jsxs)(n.section,{className:"remark-sectionize-h2",children:[(0,i.jsx)(n.h2,{id:"download-agent",children:"Download agent"}),(0,i.jsxs)(s.Z,{groupId:"k8stype2",children:[(0,i.jsxs)(l.Z,{value:"dockerinstall",label:"Docker Install",default:!0,children:[(0,i.jsxs)(n.p,{children:["To install the WhaTap application agent, create the ",(0,i.jsx)(n.em,{children:"whatap.conf"})," file. Change ",(0,i.jsx)(n.code,{children:"{YOUR_PROJECT_ROOT}"})," to the top-level path of the project to install the agent."]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cat >{YOUR_PROJECT_ROOT}/whatap.conf <<EOL\nwhatap.server.host={proxyServer}\nEOL\n"})}),(0,i.jsx)(n.h4,{id:"setting-the-kubernetes-internal-application-agent-options",children:"Setting the Kubernetes internal application agent options"}),(0,i.jsxs)(n.p,{children:["The settings required for the Kubernetes internal application agent can be configured in the ",(0,i.jsx)(n.em,{children:"whatap.conf"})," file or through the container ",(0,i.jsx)(n.code,{children:"env"})," field when releasing the agent."]}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["The options in the ",(0,i.jsx)(n.em,{children:"whatap.conf"})," file have higher priority than those set in the container ",(0,i.jsx)(n.code,{children:"env"})," field."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["If no value is set in ",(0,i.jsx)(n.em,{children:"whatap.conf"})," or container ",(0,i.jsx)(n.code,{children:"env"}),", the default value is used."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["In case of the ",(0,i.jsx)(n.code,{children:"license"})," and ",(0,i.jsx)(n.code,{children:"whatap.server.host"})," options, use the ",(0,i.jsx)(n.strong,{children:"container environment variable"})," settings."]}),"\n"]}),"\n"]}),(0,i.jsxs)(n.p,{children:["If any settings in the configuration file are changed or important settings are lost, the configuration may not work properly. Therefore, it is recommended to configure ",(0,i.jsx)(n.strong,{children:"container environment variables"})," in the Kubernetes environment. For more information about other agent control options, see ",(0,i.jsx)(n.a,{href:"https://docs.whatap.io/java/agent-control-function",children:"the following"}),"."]}),(0,i.jsxs)(n.admonition,{type:"note",children:[(0,i.jsx)(n.mdxAdmonitionTitle,{}),(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Option unavailable in the Kubernetes environment"})}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"whatap.name"}),": Unique name by which the collection server identifies agents. The name is generated based on the object on which the agent is running. Random assignment of users may cause problems with agent identification."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"whatap.onode"}),": The Kubernetes cluster node name is set by default. It is used to receive information about the node to which the agent belongs. When specified by the user, it may be difficult to accurately identify the node."]}),"\n"]}),"\n"]})]}),(0,i.jsxs)(s.Z,{children:[(0,i.jsxs)(l.Z,{value:"latest",label:"Including the latest version of the agent in the application image",default:!0,children:[(0,i.jsxs)(n.p,{children:["The following guides you to include ",(0,i.jsx)(n.strong,{children:"the latest version of the agent"})," in the application image."]}),(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["To include the WhaTap agent in the application image, add the following in the Dockerfile's final image build step. Change ",(0,i.jsx)(n.code,{children:"{YOUR_PROJECT_ROOT}"})," to the top-level path of the project to install the agent."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-docker",children:"# Create the WhaTap agent directory in the user container\nRUN mkdir -p /whatap\n\n# Copy the WhaTap Java agent to the user container\nCOPY --from=whatap/kube_mon /data/agent/micro/whatap.agent.kube.jar /whatap\n\n# Copy the created whatap.conf file to the user container\nCOPY {YOUR_PROJECT_ROOT}/whatap.conf /whatap/\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Add the following to the startup command of Dockerfile."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"-javaagent:/whatap/whatap.agent.kube.jar -Dwhatap.micro.enabled=true\n"})}),"\n",(0,i.jsx)(n.p,{children:"See the following definition example of the following Dockerfile."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-docker",metastring:"title='Dockerfile' showLineNumbers {4,7}",children:'FROM openjdk:8-jdk-slim\nRUN mkdir -p /app && mkdir /whatap\nWORKDIR /app\nCOPY --from=whatap/kube_mon /data/agent/micro/whatap.agent.kube.jar /whatap\nCOPY ./whatap.conf /whatap\nCOPY ./target/myApp.jar /app/\nCMD ["java","-javaagent:/whatap/whatap.agent.kube.jar","-Dwhatap.micro.enabled=true","-jar","/app/myApp.jar"]\nEXPOSE 8080\n'})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Build the Docker. Change ",(0,i.jsx)(n.code,{children:"{YOUR_DOCKERFILE_DIR}"})," to the path where Dockerfile is located."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-docker",children:"cd {YOUR_DOCKERFILE_DIR}\ndocker build -t {IMAGE_NAME} .\n"})}),"\n"]}),"\n"]})]}),(0,i.jsxs)(l.Z,{value:"choice",label:"Including the specified version of the agent in the application image",default:!0,children:[(0,i.jsxs)(n.p,{children:["The following guides you to include ",(0,i.jsx)(n.strong,{children:"the specified version of the agent"})," in the application image."]}),(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["To include the WhaTap agent in the application image, add the following in the Dockerfile's final image build step. Change ",(0,i.jsx)(n.code,{children:"{YOUR_PROJECT_ROOT}"})," to the top-level path of the project to install the agent."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-docker",children:"# Create the WhaTap agent directory in the user container\nRUN mkdir -p /whatap\n\n# Copy the WhaTap Java agent to the user container\nCOPY --from=whatap/kube_mon /data/agent/micro/whatap.agent-*.jar /whatap\n\n# Copy the created whatap.conf file to the user container\nCOPY {YOUR_PROJECT_ROOT}/whatap.conf /whatap/\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Check the version of the WhaTap agent."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker run whatap/kube_mon ls /data/agent/micro | grep -E 'whatap\\.agent-(.*?\\.)(.*?\\.)(.*?\\.)jar' | sort | tail -1\n\n# Output example\n## whatap.agent-X.Y.Z.jar\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Add the following to the startup command of Dockerfile. In ",(0,i.jsx)(n.strong,{children:"X.Y.Z"}),", enter the agent version that you checked before."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"-javaagent:/whatap/whatap.agent-X.Y.Z.jar -Dwhatap.micro.enabled=true\n"})}),"\n",(0,i.jsx)(n.p,{children:"See the following definition example of the following Dockerfile."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-docker",metastring:"title='Dockerfile' showLineNumbers {4,7}",children:'FROM openjdk:8-jdk-slim\nRUN mkdir -p /app && mkdir /whatap\nWORKDIR /app\nCOPY --from=whatap/kube_mon /data/agent/micro/whatap.agent-*.jar /whatap\nCOPY ./whatap.conf /whatap\nCOPY ./target/myApp.jar /app/\nCMD ["java","-javaagent:/whatap/whatap.agent-X.Y.Z.jar","-Dwhatap.micro.enabled=true","-jar","/app/myApp.jar"]\nEXPOSE 8080\n'})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Build the Docker. Change ",(0,i.jsx)(n.code,{children:"{YOUR_DOCKERFILE_DIR}"})," to the path where Dockerfile is located."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-docker",children:"cd {YOUR_DOCKERFILE_DIR}\ndocker build -t {IMAGE_NAME} .\n"})}),"\n"]}),"\n"]})]})]})]}),(0,i.jsxs)(l.Z,{value:"direct",label:"Direct Installation",children:[(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Select ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Download"})})," to download the installation file (",(0,i.jsx)(n.em,{children:"whatap.agent.java.tar.gz"}),")."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Upload the dockerfile to the server and then unzip the file."}),"\n",(0,i.jsxs)(n.admonition,{type:"info",children:[(0,i.jsx)(n.p,{children:"To download to the installation server, execute the following command."}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"wget https://api.whatap.io/agent/whatap.agent.java.tar.gz\n"})})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["When unzipped, the ",(0,i.jsx)(n.em,{children:"whatap"})," directory is created. Check the settings in the ",(0,i.jsx)(n.em,{children:"whatap.conf"})," file under the ",(0,i.jsx)(n.em,{children:"whatap"})," directory, and then modify it as follows:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ini",children:"license={licenseKey}\nwhatap.server.host={proxyServer}\n"})}),"\n",(0,i.jsxs)(n.admonition,{type:"info",children:[(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Configuring the options for the Kubernetes internal application agent"})}),(0,i.jsxs)(n.p,{children:["The settings required for the Kubernetes internal application agent can be configured in the ",(0,i.jsx)(n.em,{children:"whatap.conf"})," file or through the container ",(0,i.jsx)(n.code,{children:"env"})," field when releasing the agent."]}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["The options in the ",(0,i.jsx)(n.em,{children:"whatap.conf"})," file have higher priority than those set in the container ",(0,i.jsx)(n.code,{children:"env"})," field."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["If no value is set in ",(0,i.jsx)(n.em,{children:"whatap.conf"})," or container ",(0,i.jsx)(n.code,{children:"env"}),", the default value is used."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["In case of the ",(0,i.jsx)(n.code,{children:"license"})," and ",(0,i.jsx)(n.code,{children:"whatap.server.host"})," options, use the ",(0,i.jsx)(n.strong,{children:"container environment variable"})," settings."]}),"\n"]}),"\n"]}),(0,i.jsxs)(n.p,{children:["If any settings in the configuration file are changed or important settings are lost, the configuration may not work properly. Therefore, it is recommended to configure ",(0,i.jsx)(n.strong,{children:"container environment variables"})," in the Kubernetes environment. For more information about other agent control options, see ",(0,i.jsx)(n.a,{href:"https://docs.whatap.io/java/agent-control-function",children:"the following"}),"."]})]}),"\n",(0,i.jsxs)(n.admonition,{type:"note",children:[(0,i.jsx)(n.mdxAdmonitionTitle,{}),(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Option unavailable in the Kubernetes environment"})}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"whatap.name"}),": Unique name by which the collection server identifies agents. The name is generated based on the object on which the agent is running. Random assignment of users may cause problems with agent identification."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"whatap.onode"}),": The Kubernetes cluster node name is set by default. It is used to receive information about the node to which the agent belongs. When specified by the user, it may be difficult to accurately identify the node."]}),"\n"]}),"\n"]})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Add the following to the startup command of Dockerfile. Check the agent file under the ",(0,i.jsx)(n.em,{children:"whatap"})," directory, and then enter the version in ",(0,i.jsx)(n.strong,{children:"X.Y.Z"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"-javaagent:/whatap/whatap.agent-X.Y.Z.jar -Dwhatap.micro.enabled=true\n"})}),"\n",(0,i.jsx)(n.p,{children:"See the following definition example of the following Dockerfile."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:"title='Dockerfile'",children:'FROM openjdk:8-jdk-alpine\nRUN mkdir -p /app && mkdir /whatap\nWORKDIR /app\nCOPY ./whatap.agent-X.Y.Z.jar /whatap/\nCOPY ./whatap.conf /whatap/\nCOPY ./target/myApp.jar myApp.jar\nCOPY ./paramkey.txt /whatap/\nCMD ["java","-javaagent:/whatap/whatap.agent-X.Y.Z.jar","-Dwhatap.micro.enabled=true","-jar","/app/myApp.jar"]\nEXPOSE 8080\n'})}),"\n"]}),"\n"]}),(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.em,{children:"whatap-virtual-X.Y.Z.jar"}),": Monitoring target (sample application)"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.em,{children:"whatap.agent-X.Y.Z.jar"}),": WhaTap agent"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["If the agent's file name is ",(0,i.jsx)(n.em,{children:"whatap.agent-1.2.3.jar"}),", change the ",(0,i.jsx)(n.strong,{children:"X.Y.Z"})," part to ",(0,i.jsx)(n.strong,{children:"1.2.3"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["For more information about addition of JVM options, see ",(0,i.jsx)(n.a,{href:"https://docs.whatap.io/java/install-agent#addjvmopt",children:"the following"}),"."]}),"\n"]}),"\n"]})})]})]}),(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsxs)(n.p,{children:["For Java 17 or later, add the ",(0,i.jsx)(n.code,{children:"--add-opens=java.base/java.lang=ALL-UNNAMED"})," option related to the reflection."]})})]}),"\n",(0,i.jsxs)(n.section,{className:"remark-sectionize-h3",children:[(0,i.jsx)(n.h3,{id:"security",children:"Setting the security key"}),(0,i.jsx)(n.p,{children:"Set a security key to query SQL variables and perform HTTP queries, or use the Thread stop function."}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Java Agent 2.2.2 or later"}),"\n",(0,i.jsxs)(n.p,{children:["After creating the ",(0,i.jsx)(n.em,{children:"security.conf"})," file in the ",(0,i.jsx)(n.code,{children:"$WHATAP_HOME"})," path, enter a 6-character password consisting of alphabets and numbers as follows:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ini",metastring:"title='security.conf'",children:"paramkey=ABCDEF # SQL variable and HTTP query lookup\nthreadkill=ABCDEF # Thread stop function\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Java agent 2.2.2 or earlier"}),"\n",(0,i.jsxs)(n.p,{children:["After creating the ",(0,i.jsx)(n.em,{children:"paramkey.txt"})," file in the ",(0,i.jsx)(n.code,{children:"$WHATAP_HOME"})," path, enter a 6-character password consisting of alphabets and numbers as follows:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ini",metastring:"title='paramkey.txt'",children:"ABCDEF # SQL variable and HTTP query lookup, thread stop function\n"})}),"\n"]}),"\n"]}),(0,i.jsxs)(n.admonition,{type:"tip",children:[(0,i.jsxs)(n.p,{children:["When updating the Java agent version to 2.2.2, the key values in the existing ",(0,i.jsx)(n.em,{children:"paramkey.txt"})," file are automatically applied to the ",(0,i.jsx)(n.em,{children:"security.conf"})," file. For example, if you used ",(0,i.jsx)(n.code,{children:"FEDCBA"})," in ",(0,i.jsx)(n.em,{children:"paramkey.txt"})," and updated to the version 2.2.2, it is applied to the ",(0,i.jsx)(n.em,{children:"security.conf"})," file as follows:"]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ini",children:"paramkey=FEDCBA\nthreadkill=FEDCBA\n"})}),(0,i.jsxs)(n.p,{children:["If the ",(0,i.jsx)(n.em,{children:"paramkey.txt"})," file does not exist, the key value of the ",(0,i.jsx)(n.em,{children:"security.conf"})," file is automatically created as the key value of ",(0,i.jsx)(n.strong,{children:"WHATAP"}),"."]})]}),(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["For agent settings related to recording SQL parameters, see ",(0,i.jsx)(n.a,{href:"../java/agent-dbsql#profile-sql-param",children:"the following"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["For agent settings related to recording the HTTP parameters, see ",(0,i.jsx)(n.a,{href:"../java/agent-transaction#profile_http_parameter",children:"the following"}),"."]}),"\n"]}),"\n"]})})]}),"\n",(0,i.jsxs)(n.section,{className:"remark-sectionize-h2",children:[(0,i.jsx)(n.h2,{id:"configuring-the-container-environment-variables",children:"Configuring the container environment variables"}),(0,i.jsxs)(n.p,{children:["After building Docker, set ",(0,i.jsx)(n.strong,{children:"container environment variables"})," in the Kubernetes environment. Add the following items in the ",(0,i.jsx)(n.em,{children:"yaml"})," file for releasing the application."]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'env:\n- name: NODE_IP\n  valueFrom: {fieldRef: {fieldPath: status.hostIP}}\n- name: NODE_NAME\n  valueFrom: {fieldRef: {fieldPath: spec.nodeName}}\n- name: POD_NAME\n  valueFrom: {fieldRef: {fieldPath: metadata.name}}\n- name: OKIND\n  value: {YOUR_OKIND_NAME}\n- name: license\n  value: {licenseKey}\n- name: whatap.server.host\n  value: {proxyServer}\n- name: whatap.micro.enabled\n  value: "true"\n'})}),(0,i.jsx)(n.p,{children:"See the following example:"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: #DeploymentName\n  labels:\n    app: #AppLabel\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: #AppLabel\n  template:\n    metadata:\n      labels:\n        app: #AppLabel\n    spec:\n      containers:\n      - name: #ContainerName\n        image: nginx\n        ports:\n        - containerPort: 80\n        env:\n        - name: NODE_IP\n          valueFrom: {fieldRef: {fieldPath: "status.hostIP"}}\n        - name: NODE_NAME\n          valueFrom: {fieldRef: {fieldPath: "spec.nodeName"}}\n        - name: POD_NAME\n          valueFrom: {fieldRef: {fieldPath: "metadata.name "}}\n        - name: OKIND\n          value: #DeploymentName\n        - name: license\n          value: #licenseKey\n        - name: whatap.server.host\n          value: #proxyServer\n        - name: whatap.micro.enabled\n          value: "true"\n'})}),(0,i.jsxs)(n.admonition,{type:"note",children:[(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Roles of environment variables"})}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"NODE_IP"}),": Collects the IP address of the node where the current Pod has been hosted."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"NODE_NAME"}),": Collects the name of the node where the current Pod is running."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"POD_NAME"}),": Collects the name of the current Pod."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"OKIND"})," (optional): Groups applications for Pods. If set to a deployment name, the corresponding Pods are grouped together."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"license"}),": Key for agent authentication."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"whatap.server.host"}),": Host IP of the WhaTap collection server"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"whatap.micro.enabled"}),": Enables integration with containers."]}),"\n"]}),"\n"]})]}),(0,i.jsx)(c,{})]})]})}function m(e={}){let{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(j,{...e})}):j(e)}},5525:function(e,n,t){t.d(n,{Z:()=>s});var a=t("85893");t("67294");var i=t("67026");let r="tabItem_Ymn6";function s(e){let{children:n,hidden:t,className:s}=e;return(0,a.jsx)("div",{role:"tabpanel",className:(0,i.Z)(r,s),hidden:t,children:n})}},47902:function(e,n,t){t.d(n,{Z:()=>w});var a=t("85893"),i=t("67294"),r=t("67026"),s=t("69599"),l=t("16550"),o=t("32000"),c=t("4520"),h=t("38341"),d=t("76009");function p(e){return i.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||i.isValidElement(e)&&function(e){let{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function u(e){let{value:n,tabValues:t}=e;return t.some(e=>e.value===n)}var j=t("7227");let m="tabList__CuJ",g="tabItem_LNqP";function x(e){let{className:n,block:t,selectedValue:i,selectValue:l,tabValues:o}=e,c=[],{blockElementScrollPositionUntilNextRender:h}=(0,s.o5)(),d=e=>{let n=e.currentTarget,t=o[c.indexOf(n)].value;t!==i&&(h(n),l(t))},p=e=>{let n=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{let t=c.indexOf(e.currentTarget)+1;n=c[t]??c[0];break}case"ArrowLeft":{let t=c.indexOf(e.currentTarget)-1;n=c[t]??c[c.length-1]}}n?.focus()};return(0,a.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.Z)("tabs",{"tabs--block":t},n),children:o.map(e=>{let{value:n,label:t,attributes:s}=e;return(0,a.jsx)("li",{role:"tab",tabIndex:i===n?0:-1,"aria-selected":i===n,ref:e=>c.push(e),onKeyDown:p,onClick:d,...s,className:(0,r.Z)("tabs__item",g,s?.className,{"tabs__item--active":i===n}),children:t??n},n)})})}function f(e){let{lazy:n,children:t,selectedValue:s}=e,l=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){let e=l.find(e=>e.props.value===s);return e?(0,i.cloneElement)(e,{className:(0,r.Z)("margin-top--md",e.props.className)}):null}return(0,a.jsx)("div",{className:"margin-top--md",children:l.map((e,n)=>(0,i.cloneElement)(e,{key:n,hidden:e.props.value!==s}))})}function v(e){let n=function(e){let{defaultValue:n,queryString:t=!1,groupId:a}=e,r=function(e){let{values:n,children:t}=e;return(0,i.useMemo)(()=>{let e=n??p(t).map(e=>{let{props:{value:n,label:t,attributes:a,default:i}}=e;return{value:n,label:t,attributes:a,default:i}});return!function(e){let n=(0,h.lx)(e,(e,n)=>e.value===n.value);if(n.length>0)throw Error(`Docusaurus error: Duplicate values "${n.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[n,t])}(e),[s,j]=(0,i.useState)(()=>(function(e){let{defaultValue:n,tabValues:t}=e;if(0===t.length)throw Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!u({value:n,tabValues:t}))throw Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${t.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}let a=t.find(e=>e.default)??t[0];if(!a)throw Error("Unexpected error: 0 tabValues");return a.value})({defaultValue:n,tabValues:r})),[m,g]=function(e){let{queryString:n=!1,groupId:t}=e,a=(0,l.k6)(),r=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:n,groupId:t}),s=(0,c._X)(r);return[s,(0,i.useCallback)(e=>{if(!r)return;let n=new URLSearchParams(a.location.search);n.set(r,e),a.replace({...a.location,search:n.toString()})},[r,a])]}({queryString:t,groupId:a}),[x,f]=function(e){var n;let{groupId:t}=e;let a=(n=t)?`docusaurus.tab.${n}`:null,[r,s]=(0,d.Nk)(a);return[r,(0,i.useCallback)(e=>{if(!!a)s.set(e)},[a,s])]}({groupId:a}),v=(()=>{let e=m??x;return u({value:e,tabValues:r})?e:null})();return(0,o.Z)(()=>{v&&j(v)},[v]),{selectedValue:s,selectValue:(0,i.useCallback)(e=>{if(!u({value:e,tabValues:r}))throw Error(`Can't select invalid tab value=${e}`);j(e),g(e),f(e)},[g,f,r]),tabValues:r}}(e);return(0,a.jsxs)("div",{className:(0,r.Z)("tabs-container",m),children:[(0,a.jsx)(x,{...n,...e}),(0,a.jsx)(f,{...n,...e})]})}function w(e){let n=(0,j.Z)();return(0,a.jsx)(v,{...e,children:p(e.children)},String(n))}},50065:function(e,n,t){t.d(n,{Z:function(){return l},a:function(){return s}});var a=t(67294);let i={},r=a.createContext(i);function s(e){let n=a.useContext(r);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),a.createElement(r.Provider,{value:n},e.children)}}}]);