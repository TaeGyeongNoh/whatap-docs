**Multi-transaction** means the transaction involving a different agent or project. **Multiple Transaction Trace** is to trace calls between the application services registered in the WhaTap project. 

<InDoc product="java">

:::info

The Java agent traces multi-transactions with three HTTP header keys (`x-wtap-po`, `x-wtap-mst`, and `x-wtap-sp1`). If HTTP transactions passing through the gateway cannot be traced, check the HTTP header conditions.

:::

</InDoc>

:::note

**Enabling the multi-transaction**

To trace multiple transactions, set the `mtrace_enabled` option to `true` in <Cmdname sid="side_management" className="uitext" /> &gt; <Cmdname sid="side_agentSetting" className="uitext" />. For more information about the agent configuration, see [the following](set-agent#set-agent-service).

:::

## Multiple transaction trace {#trace-multi-tx}

Drag the chart area in Home &gt; Select Project &gt; <Cmdname sid="side_analysis" className="uitext" /> &gt; <Cmdname sid="side_hitmap" className="uitext" />. The transaction information of the dragged chart area appears in the <Cmdname sid="trace_list" className="uitext" /> list at the bottom. Transactions including multi-transactions in the list are marked with the ![Icon](/img/ic-s-mult-transation.svg) icon.

<ImgLang img='tx-trace-table.png' desc='mtrace_M' />

When you select the trace, the <Cmdname sid="TTL06527" className="uitext" /> window appears. If multi-transactions are being traced, you can see the <Cmdname sid="TTL06107" className="uitext" /> in the <Cmdname sid="TTL06125" className="uitext" /> tab. Even if you make an outbound call in transaction, the same <Cmdname sid="TTL06107" className="uitext" /> is generated. If projects are separated by service, all transactions between applications can be verified through the first issued <Cmdname sid="TTL06107" className="uitext" />. For more information about the detailed analysis of TX traces using the <Cmdname sid="TTL06527" className="uitext" /> window, see [the following](trs-profile#details).

<ImgLang img='tx-trace-dt-up.png' desc='Record summary' />

If you select <Cmdname sid="TTL06107" className="uitext" />, the <Cmdname sid="TTL06377" className="uitext" /> tab appears. The transactions and trace data are provided so that you can see various call relationships at a glance within or between systems, and identify where problems occurred for improvement.

### Chart {#trace-multi-tx-chart}

<ImgLang img='multi-tx-cht.png' desc='Chart' />

The default screen for <Cmdname sid="TTL06377" className="uitext" /> is <Cmdname sid="BTN07120" className="uitext" />. <Cmdname sid="BTN07120" className="uitext" /> clearly provides you with call relationships for each transaction. You can check individual execution times for transaction services with the same <Cmdname sid="TTL06107" className="uitext" />. You can see the call relationships between transactions through the step times (![number 1](/img/number-01.png) <Cmdname sid="time_bar" className="uitext" />) expressed in background colors for transaction nodes. In the <Cmdname sid="BTN07120" className="uitext" />, you can use the mouse to move to a desired position or zoom in or out by scrolling.

- ![Filter icon](/img/ico-filter.svg) <Cmdname sid="TLT06410" className="uitext" />: You can select or deselect projects to be displayed on the chart.

- ![Configuration icon](/img/ico-setting.svg) <Cmdname sid="TLT06411" className="uitext" />: You can display or hide the elements on the chart.

  - <Cmdname sid="time_bar" className="uitext" />: You can display or hide the step times (<Cmdname sid="time_bar" className="uitext" />) for each node.

  - <Cmdname sid="application_name" className="uitext" />: You can display or hide the agent names (oname) for each node.

  - <Cmdname sid="project" className="uitext" />: You can display or hide the project names for each node.

  - <Cmdname sid="database" className="uitext" /> / <Cmdname sid="apply_external_remote" className="uitext" /> / <Cmdname sid="apply_internal_remote" className="uitext" />: Connection requests for other databases or HTTP calls that occurred in the transaction can also be viewed through the nodes of the chart.

If you select a transaction node, an additional <Cmdname sid="TTL06527" className="uitext" /> window appears as follows. The transaction trace allows you to see the transaction details. For more information about the detailed analysis of transaction trace through the <Cmdname sid="TTL06527" className="uitext" /> window, see [the following](trs-profile#details).

<ImgLang img='multi-tx-additional-info.png' desc='Display Detail of Multi-transaction' />

### Table {#trace-multi-tx-table}

If you click <Cmdname sid="BTN07121" className="uitext" />, in the form of table, you can see the data for each transaction included in multi-transactions.

<ImgLang img='multi-tx-table-mode.png' desc='Multi-transaction table mode' />

- ![Filter icon](/img/ico-filter.svg) <Cmdname sid="TLT06410" className="uitext" />: You can select or deselect projects to be displayed on the chart.

- ![Column icon](/img/ic-column.svg) <Cmdname sid="BTN06441" className="uitext" />: You can edit the columns in the table. 

When you select each transaction, the <Cmdname sid="TTL06527" className="uitext" /> window for the selected transaction appears, similar to selecting a node in the <Cmdname sid="BTN07120" className="uitext" /> tab. You can see the details of the transaction through the transaction trace. For more information about the detailed analysis of transaction traces using the <Cmdname sid="TTL06527" className="uitext" /> window, see [the following](trs-profile#transaction-info).

### Tree {#trace-multi-tx-tree}

If you select <Cmdname sid="BTN06296" className="uitext" />, you can see the detailed information for each transaction and their traces. The transactions within the overall transaction time or start times and step times of each trace to provide transaction call relationships in a tree format.

<ImgLang img='multi-tx-tree-mode.png' desc='Multi-transaction tree mode' />

- ![Filter icon](/img/ico-filter.svg) <Cmdname sid="TLT06410" className="uitext" />: You can select or deselect projects to be displayed on the chart.

- ![View one line icon](/img/ic-single-line.svg) <Cmdname sid="BTN06368" className="uitext" />: You can arrange the tree format at intervals by displaying the texts displayed in the execution data for each section in a single line.

- ![View multiple lines icon](/img/ic-multi-line.svg) <Cmdname sid="BTN06369" className="uitext" />: All the texts displayed in the execution data for each section, appear by wrapping words.

- <Cmdname sid="BTN06327" className="uitext" />: The longest route can appear.

- ![Chart icon](/img/ic-bar-chart.svg) <Cmdname sid="BTN06743" className="uitext" />: The elapsed times are displayed in a bar chart.

- ![Time icon](/img/ic-custom-time.svg) <Cmdname sid="BTN06744" className="uitext" />: The timestamps, gaps, and elapsed times for each segment are displayed in text.

  - 8 seconds or more: <span class='etrs'>Excessive delay</span> state is distinguished in <span class='etrs'>red</span>.

  - Between 3 and 8 seconds: <span class='ov5ud10'>Delay</span> state is distinguished in <span class='ov5ud10'>orange</span>.

  - Less than 3 seconds: <span class='woer'>Normal</span> state is distinguished in <span class='woer'>blue</span>.

  :::note

  In case of start and step times, the time differences caused by the transaction call environment are corrected on the screen through traces and mappings in the parent transactions. Accordingly, there may be differences from the actual time data.

  :::

- ![Hide icon](/img/ic-eye-invisible.svg) <Cmdname sid="BTN06745" className="uitext" />: The time is hidden.

:::note

- When you select ![Statistics icon](/img/ic-static.svg) or ![Popup icon](/img/ic-popup.svg) of the trace, you can see the detailed information such as <Cmdname sid="remote_http_call_statistics" className="uitext" />, <Cmdname sid="activestack" className="uitext" /> and <UI>SQL</UI>.

- By selecting ![Copy icon](/img/ico-copy.svg) of an SQL step, you can copy the SQL statement of the step.

:::
