---
id: agent-troubleshooting
title: Agent troubleshooting
description: You can check the problems that may occur during the agent installation.
hide_table_of_contents: true
toc_max_heading_level: 2
keywords:
  - Kubernetes
  - Kubernetes Monitoring
  - Troubleshooting
  - Troubleshooting
  - Agent issues
---

## Installation troubleshooting based on the Helm chart {#troubleshooting-helm-chart}

<div class ='faq'>

### In case there is a `whatap` Helm repository with the same name

| "whatap" already exists with the same configuration, skipping |
| ------------------------------------------------------------- |

If another `whatap` repository with the same name already exists, delete the existing `whatap` repository by using the following command and then proceed with installation.

```shell
helm repo remove whatap
```

### In case there is another namespace named `whatap-monitoring` in the cluster

| Error: INSTALLATION FAILED: Unable to continue with install: Namespace "whatap-monitoring" in namespace "" exists and cannot be imported into the current release |
| ----------------------------------------------------------------------------------------------------------------------------------------------------------------- |

If the `whatap-monitoring` namespace exists in the cluster, it is because the user has already installed the Whatap Kubernetes agent based on the _yaml_ file. In this case, delete the existing `whatap-monitoring` namespace and related resources by using the following commands.

```shell
kubectl delete namespace whatap-monitoring
kubectl delete clusterrolebinding whatap
kubectl delete clusterrole whatap
```

### In case the `clusterrole` and `clusterrolebinding` resources exist in the cluster

| Error: INSTALLATION FAILED: Unable to continue with install: ClusterRole "whatap" in namespace "" exists and cannot be imported into the current release |
| -------------------------------------------------------------------------------------------------------------------------------------------------------- |

If the `clusterrole` and `clusterrolebinding` resources already exist in the cluster, delete them by using the following commands.

```shell
kubectl delete clusterrolebinding whatap
kubectl delete clusterrole whatap
```

</div>

## Troubleshooting issues that occur when starting the agent {#troubleshooting-agent}

<div class ='faq'>

### In case of installation of WhaTap Kubernetes Monitoring via an old YAML file

| Unrecognized VM option 'UseCGroupMemoryLimitForHeap'<br/>Error: Could not create the Java Virtual Machine.<br/>Error: A fatal exception has occurred. Program will exit. |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |

If you installed WhaTap Kubernetes Monitoring via the installation _YAML_ downloaded before **August 24, 2022**, you may encounter an error or failure to start the node agent (whatap-node-agent). 

#### Cause

- The installation _YAML_ file downloaded before August 24, 2022 contains a node agent launch script using the `UseCGroupMemoryLimitForHeap` JVM option. 

- Starting from WhaTap node agent 1.2.0 (released on November 21, 2022), the JDK used in the agent has been upgraded, and the upgraded JDK version no longer provides the `UseCGroupMemoryLimitForHeap` option.

- If you run the node agent 1.2.0 or later with the WhaTap Kubernetes Monitoring installed using a _YAML_ file downloaded before August 24, 2022, the startup fails with the message `Unrecognized VM option 'UseCGroupMemoryLimitForHeapâ€™`.

#### solved

Reinstall WhaTap Kubernetes Monitoring by following the steps below:

1. Download the latest _YAML_ file by using **_Management_** > **_Agent install_**.

2. Install the agent by using the _YAML_ file downloaded from the Kubernetes environment. 

3. Check whether any errors are output during installation in the Kubernetes environment.

4. Make sure the WhaTap monitoring agent Pod is in Running state.

   :::note 

   Check the Kubernetes environment and the **_Workload_** > **_Pod list_** menu.

   :::

5. Check the logs generated by each monitoring agent through **_Management_** > **_Kubernetes agent list_**.

</div>
